// exports all text from the document// into a textfile on a choosen location// Copyright (c)  2012 // Fabian "fabiantheblind" Morón Zirfas  // Permission is hereby granted, free of charge, to any // person obtaining a copy of this software and associated// documentation files (the "Software"), to deal in the Software// without restriction, including without limitation the rights // to use, copy, modify, merge, publish, distribute, sublicense,// and/or sell copies of the Software, and to  permit persons to // whom the Software is furnished to do so, subject to // the following conditions:  // The above copyright notice and this permission notice// shall be included in all copies or substantial portions of the Software.  // THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES// OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF  CONTRACT,// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTIO// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.  // see also http://www.opensource.org/licenses/mit-license.php{main();/** *  everything in here * */ function main(){var doc = app.activeDocument; // the document// choose the foldervar newLocation = Folder.selectDialog("Select a output folder...");var fn =  "file " + doc.name; //  add the docname to the filename	var tf = newLocation.fsName;// this is filehandling works on win and osx	var txtFile =  new File( tf+"/" + fn + ".txt" ); // the full path to the file	var allStories = new Array();// a new array for the textparts// loop all storiesfor (var i = 0; i < doc.stories.length; i++) {	var story = doc.stories[i]; // single it out	allStories.push(story.contents);// push into array};// end loop i doc.storieswriteArray(txtFile, allStories); // maker the file    }; // end function main/** *  Exports all stories into one textfile *   */ function writeArray (txtFile , arr ){    var out; // our output  // only if there is a file   if( txtFile!='' ){         //Open the file for writing.         out = txtFile.open( 'e', undefined, undefined );      txtFile.encoding = "UTF-8"; // encoding      txtFile.lineFeed = "Unix"; //convert to UNIX linefeed   }; // ebd if textfile   if( out != false ){    // loop the given array and push it into the file file         for(var i in arr){      txtFile.writeln(arr[i]);     }; // and i arr loop      txtFile.close();        // txtFile.execute();  // could be called    }; // end out false}; // end function write array }